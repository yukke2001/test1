# DEVELOPMENT_GUIDE.md - 開発ガイドライン（更新版）

## 🎯 Agentモード開発での注意事項（2025/12/04更新）

### 新しい開発ルール

#### ✅ 基本方針
- **削除禁止**: 既存ファイルの削除は絶対に禁止
- **変更許可**: 品質向上のための既存ファイル変更は許可
- **品質重視**: 開発品質を最優先とする

#### ✅ 開発手法の選択
1. **既存ファイルの評価**
   - 既存ファイルの品質、機能性、保守性を評価
   - コードの可読性、拡張性、パフォーマンスを確認

2. **最適な手法選択**
   - 既存ファイルが優秀 → 既存ファイルを拡張・改良
   - 既存ファイルが不十分 → 新規ファイル作成
   - 両方の利点を活かす混合アプローチも可

### 正しい指示例

#### ✅ 推奨される指示例
```
「神経衰弱ゲームにタイマー機能を追加してください。

【重要な条件】
・既存ファイルの削除は禁止
・既存ファイルの品質を評価してから開発手法を決定
・既存のgame.jsp、result.jspが優秀なら既存ファイルを拡張
・既存ファイルが不十分なら新規ファイルを作成
・開発品質を最優先とする
・FILE_PROTECTION.txtの削除禁止リストを確認」
```

#### ❌ 避けるべき指示例
```
「新機能を追加してください」（曖昧すぎる）
「既存ファイルは一切変更しないでください」（品質を損なう制約）
「もっと良くしてください」（範囲が不明確）
```

## 📁 推奨ディレクトリ構造

### 新規作成推奨フォルダ
```
Test02/
├── features/                     # 新機能専用
│   ├── score_system/            # スコア機能
│   │   ├── score_feature.jsp
│   │   ├── score_feature.css
│   │   └── score_feature.js
│   ├── multiplayer/             # マルチプレイヤー機能
│   │   ├── multiplayer_feature.jsp
│   │   ├── multiplayer_feature.css
│   │   └── multiplayer_feature.js
│   └── themes/                  # テーマ機能
│       ├── theme_feature.jsp
│       ├── dark_theme.css
│       └── light_theme.css
├── assets/                      # 共通アセット
│   ├── css/                     # 新しいCSS
│   ├── js/                      # JavaScript
│   └── images/                  # 画像ファイル
└── backup/                      # 手動バックアップ
    ├── 20251204/               # 日付フォルダ
    └── emergency/              # 緊急時バックアップ
```

## 🛠️ 開発ワークフロー

### Step 1: 開発前準備
1. 現在のプロジェクト状態確認
2. 影響範囲の特定
3. バックアップファイルの作成（必要に応じて）

### Step 2: 新機能実装
1. 新しいディレクトリ/ファイルの作成
2. 機能実装
3. 既存機能との統合テスト

### Step 3: 統合とテスト
1. 既存機能への影響確認
2. 全体動作テスト
3. 問題があれば新規ファイルのみ修正

## 📋 コーディング規約

### JSPファイル
```jsp
<%-- 
ファイル名: [機能名]_feature.jsp
作成日: 2025/12/04
機能概要: [機能の説明]
変更履歴:
- 2025/12/04: 初期作成
--%>

<%@ page language="java" contentType="text/html; charset=UTF-8" pageEncoding="UTF-8"%>
<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>[機能名] - 神経衰弱ゲーム</title>
    <link rel="stylesheet" type="text/css" href="[機能名]_feature.css">
</head>
<body>
    <!-- 新機能実装 -->
</body>
</html>
```

### CSSファイル
```css
/*
ファイル名: [機能名]_feature.css
作成日: 2025/12/04
適用対象: [機能名]_feature.jsp
変更履歴:
- 2025/12/04: 初期作成
*/

/* 新機能スタイル */
.feature-container {
    /* スタイル定義 */
}
```

## 🔧 トラブルシューティング

### 問題：既存ファイルが削除された場合
1. `backup/` フォルダから復元
2. Git履歴から復元（利用可能な場合）
3. `*_backup.jsp` ファイルから手動復元

### 問題：新機能が既存機能と競合
1. 新機能を一時的に無効化
2. 既存機能の動作確認
3. 段階的に新機能を統合

## 📝 コメント規約

### 重要ファイルの先頭コメント
```jsp
<%--
⚠️ 重要ファイル - 変更前にバックアップ必須
このファイルは神経衰弱ゲームのコアファイルです。
変更時は必ず事前にバックアップを作成してください。
--%>
```

### 変更履歴の記録方法
```jsp
<%--
変更履歴:
- 2025/12/04: ファイル作成 (Agent)
- 2025/12/05: スコア機能追加 (Agent) - 新規ファイルscore_feature.jsp作成
- 2025/12/06: UI改善 (Agent) - 既存ファイル変更なし、新規CSS追加
--%>
```

## 🚀 パフォーマンス考慮事項

### CSSファイルの読み込み順序
1. 基本スタイル（`game.css`）
2. 機能別スタイル（`*_feature.css`）
3. エフェクト・アニメーション（`card_effects.css`）

### JavaScriptファイルの読み込み
- 新機能のJSは非同期読み込み推奨
- 既存機能への依存を最小化

## 📊 品質保証

### テストチェックリスト
- [ ] 既存機能の動作確認
- [ ] 新機能の単体テスト
- [ ] ブラウザ互換性確認
- [ ] レスポンシブデザイン確認
- [ ] エラーハンドリング確認

### リリース前確認事項
- [ ] 全既存ファイルの存在確認
- [ ] バックアップファイルの存在確認
- [ ] 新機能の動作確認
- [ ] パフォーマンステスト
