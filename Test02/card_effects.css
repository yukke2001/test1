/*
【神経衰弱ゲーム - カードエフェクト専用CSS】
card_effects.css

リアルなカードめくりエフェクトとアニメーションを提供
- 3Dフリップアニメーション
- ホバーエフェクト
- クリック時の反応
- ペア成立時のエフェクト
*/

/* カード3Dエフェクトの基本設定 */
.card {
    perspective: 1000px !important;
    transform-style: preserve-3d !important;
    transition: all 0.6s ease !important;
    /* ランダムレイアウトの回転を保持しつつエフェクトを追加 */
    position: absolute !important;
}

/* カード面の基本構造（表と裏の2面） */
.card-front, .card-back {
    position: absolute !important;
    width: 100% !important;
    height: 100% !important;
    border-radius: 8px !important;
    backface-visibility: hidden !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
    transition: all 0.6s ease !important;
}

/* カードの裏面（?が表示される面） */
.card-back {
    background: linear-gradient(145deg, #4a5568, #2d3748) !important;
    color: white !important;
    font-size: 36px !important;
    font-weight: bold !important;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5) !important;
    border: 3px solid #e2e8f0 !important;
    box-shadow: 
        inset 0 0 20px rgba(255,255,255,0.1),
        0 8px 16px rgba(0,0,0,0.3) !important;
}

/* カードの表面（値が表示される面） */
.card-front {
    background: linear-gradient(145deg, #f8f8f8, #e2e8f0) !important;
    color: #2d3748 !important;
    font-size: 28px !important;
    font-weight: bold !important;
    border: 3px solid #cbd5e0 !important;
    transform: rotateY(180deg) !important;
    box-shadow: 
        inset 0 0 20px rgba(0,0,0,0.05),
        0 8px 16px rgba(0,0,0,0.2) !important;
}

/* フリップされたカード（表向き）の状態 */
.card.flipped .card-back {
    transform: rotateY(-180deg) !important;
}

.card.flipped .card-front {
    transform: rotateY(0deg) !important;
}

/* ホバーエフェクト（カードに触れた時） - ランダム回転を保持 */
.card:hover {
    /* 元の回転を保持しつつエフェクトを追加 */
    filter: brightness(1.1) drop-shadow(0 15px 30px rgba(0,0,0,0.4)) !important;
    z-index: 10 !important;
    /* transformはランダムレイアウトの値を維持 */
}

/* クリック時のエフェクト - ランダム回転を保持 */
.card:active, .card.flipping {
    filter: brightness(1.2) drop-shadow(0 8px 20px rgba(255,215,0,0.5)) !important;
    transition: all 0.1s ease !important;
}

/* カードボタンのスタイリング */
.card-btn {
    width: 100% !important;
    height: 100% !important;
    background: transparent !important;
    border: none !important;
    color: white !important;
    font-size: 36px !important;
    font-weight: bold !important;
    cursor: pointer !important;
    border-radius: 8px !important;
    transition: all 0.3s ease !important;
    text-shadow: 2px 2px 4px rgba(0,0,0,0.5) !important;
}

/* カードボタンのホバーエフェクト */
.card-btn:hover {
    color: #ffd700 !important;
    text-shadow: 
        0 0 10px rgba(255,215,0,0.5),
        2px 2px 4px rgba(0,0,0,0.5) !important;
    transform: scale(1.1) !important;
}

/* カードボタンのクリック時エフェクト */
.card-btn:active {
    transform: scale(0.95) !important;
    color: #ffed4e !important;
}

/* 表向きカードの改善されたスタイル */
.card.open span {
    font-size: 28px !important;
    font-weight: bold !important;
    color: #2d3748 !important;
    text-shadow: 1px 1px 3px rgba(0,0,0,0.2) !important;
    animation: cardReveal 0.6s ease forwards !important;
    background: linear-gradient(145deg, #f7fafc, #edf2f7) !important;
    border-radius: 8px !important;
    width: 100% !important;
    height: 100% !important;
    display: flex !important;
    align-items: center !important;
    justify-content: center !important;
}

/* ゲーム進行中のカード間の微細な相互作用効果 */
.cards:hover .card:not(:hover) {
    opacity: 0.8 !important;
    transition: opacity 0.3s ease !important;
}

/* ペア成立時の祝福エフェクト */
.card.matched {
    animation: matchSuccess 1.5s ease forwards !important;
}

@keyframes matchSuccess {
    0% {
        transform: scale(1) rotate(0deg) !important;
    }
    25% {
        transform: scale(1.2) rotate(5deg) !important;
        box-shadow: 0 0 30px rgba(255,215,0,0.8) !important;
    }
    50% {
        transform: scale(1.1) rotate(-5deg) !important;
        background: linear-gradient(145deg, #ffd700, #ffed4e) !important;
    }
    75% {
        transform: scale(1.15) rotate(2deg) !important;
    }
    100% {
        transform: scale(0.8) rotate(0deg) !important;
        opacity: 0.3 !important;
        filter: brightness(0.7) !important;
    }
}

/* カード表示アニメーション */
@keyframes cardReveal {
    0% {
        opacity: 0 !important;
        transform: scale(0.8) !important;
    }
    50% {
        opacity: 1 !important;
        transform: scale(1.1) !important;
    }
    100% {
        opacity: 1 !important;
        transform: scale(1) !important;
    }
}

/* カードフリップアニメーション */
@keyframes cardFlip {
    0% {
        transform: rotateY(0deg) !important;
    }
    50% {
        transform: rotateY(-90deg) scale(1.1) !important;
    }
    100% {
        transform: rotateY(-180deg) !important;
    }
}

/* 次へボタンのエンハンス */
.next-btn {
    background: linear-gradient(145deg, #48bb78, #38a169) !important;
    color: white !important;
    border: none !important;
    padding: 15px 30px !important;
    font-size: 18px !important;
    font-weight: bold !important;
    border-radius: 25px !important;
    cursor: pointer !important;
    transition: all 0.3s ease !important;
    box-shadow: 0 8px 16px rgba(0,0,0,0.2) !important;
    text-transform: uppercase !important;
    letter-spacing: 1px !important;
}

.next-btn:hover {
    transform: translateY(-3px) scale(1.05) !important;
    box-shadow: 0 12px 24px rgba(0,0,0,0.3) !important;
    background: linear-gradient(145deg, #68d391, #48bb78) !important;
}

.next-btn:active {
    transform: translateY(-1px) scale(0.98) !important;
    transition: all 0.1s ease !important;
}

/* パルス効果 - 重要な要素に注意を向ける */
.pulse-effect {
    animation: pulse 2s infinite !important;
}

@keyframes pulse {
    0% {
        box-shadow: 0 0 0 0 rgba(72, 187, 120, 0.7) !important;
    }
    70% {
        box-shadow: 0 0 0 10px rgba(72, 187, 120, 0) !important;
    }
    100% {
        box-shadow: 0 0 0 0 rgba(72, 187, 120, 0) !important;
    }
}

/* レスポンシブ対応 */
@media (max-width: 768px) {
    .card {
        width: 70px !important;
        height: 100px !important;
        font-size: 20px !important;
    }
    
    .card-btn {
        font-size: 28px !important;
    }
    
    .card.open span {
        font-size: 22px !important;
    }

    .card-btn:active {
        background-color: rgba(255, 215, 0, 0.2) !important;
        transform: scale(0.9) !important;
    }
    
    .card:active {
        filter: brightness(1.3) !important;
    }
}

/* 消去されたカードのフェードアウト効果 */
.card.gone {
    animation: fadeOut 0.8s ease forwards !important;
}

@keyframes fadeOut {
    0% {
        opacity: 1 !important;
        transform: scale(1) !important;
    }
    50% {
        opacity: 0.5 !important;
        transform: scale(1.1) rotate(10deg) !important;
    }
    100% {
        opacity: 0 !important;
        transform: scale(0.8) rotate(20deg) !important;
        visibility: hidden !important;
    }
}

/* 紙吹雪アニメーション */
@keyframes fall {
    0% {
        transform: translateY(-10vh) rotate(0deg);
        opacity: 1;
    }
    100% {
        transform: translateY(110vh) rotate(360deg);
        opacity: 0;
    }
}

/* カード出現アニメーション */
@keyframes cardAppear {
    0% {
        opacity: 0;
        transform: translateY(30px) scale(0.8);
    }
    100% {
        opacity: 1;
        transform: translateY(0px) scale(1);
    }
}

/* 特別なマッチ成功パーティクルエフェクト */
.particle-effect {
    position: fixed;
    pointer-events: none;
    z-index: 1000;
    width: 6px;
    height: 6px;
    border-radius: 50%;
    animation: particlePop 1s ease-out forwards;
}

@keyframes particlePop {
    0% {
        opacity: 1;
        transform: scale(0) translate(0, 0);
    }
    50% {
        opacity: 1;
        transform: scale(1) translate(var(--random-x, 0px), var(--random-y, 0px));
    }
    100% {
        opacity: 0;
        transform: scale(0.5) translate(var(--random-x, 0px), var(--random-y, 0px));
    }
}

/* 成功時のパーティクル効果の改善 */
.success-sparkle {
    position: absolute !important;
    width: 4px !important;
    height: 4px !important;
    background: #ffd700 !important;
    border-radius: 50% !important;
    pointer-events: none !important;
    animation: sparkle 1.5s ease-out forwards !important;
}

@keyframes sparkle {
    0% {
        opacity: 1;
        transform: scale(0) rotate(0deg);
    }
    50% {
        opacity: 1;
        transform: scale(1) rotate(180deg);
    }
    100% {
        opacity: 0;
        transform: scale(0.5) rotate(360deg);
    }
}
